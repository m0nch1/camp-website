<!DOCTYPE html>
<html lang="ja">
<head>
  <title>数当てゲーム</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" >
  <style>
    #guessGame {
      margin: 20px;
    }

    #guessGame input {
      width: 200px;
    }
  </style>
</head>
<body>

<main class="container">
  <h1>数当てゲーム (1~100)</h1>
  
  <div id="guessGame">
    <label for="guessField">予想: </label>
    <input type="number" min="1" max="100" id="guessField">
    <input type="submit" value="予想を入力" id="guessSubmit">
    <input type="button" value="リセット" id="guessReset" style="background-color: red; color: white;">
    <p id="guessResult"></p>
    <div id="zanki"></div>
  </div>

  <audio id="audio"></audio>
</main>

<script>
  // 1から100までのランダムな整数を生成し、コンソールにログを出力
  let answerNumber = Math.floor(Math.random() * 100) + 1;
  console.log('正解は' + answerNumber);

  let zanki = 10; // 残りの試行回数

  // 残り回数を表示するフィールドを取得
  let zankiField = document.querySelector('#zanki');
  zankiField.textContent = '残り回数: ' + zanki;

  // 数値入力フィールドを取得
  let guessField = document.querySelector('#guessField');

  // submitボタンを取得
  let guessSubmit = document.querySelector('#guessSubmit');

  // 結果を表示する要素を取得
  let guessResult = document.querySelector('#guessResult');

  // resetボタンを取得
  let guessReset = document.querySelector('#guessReset');

  let audio = document.querySelector('#audio'); // audio要素を取得
  audio.src = 'boss.mp3'; // ファイルパスを設定

  // ユーザーの入力をチェックし、結果を表示
  function checkGuess() {
    // ユーザの入力した値を取得
    let userGuess = Number(guessField.value);

    // 一時停止中かどうかで処理を分岐
    if (audio.paused) {
    // 一時停止中の場合は再生
      audio.play();
    }

    zanki--; // 残り回数を1減らす
    zankiField.textContent = '残り回数: ' + zanki; // 残り回数を更新

    if (zanki === 0) { // 残り回数が0になった場合
      guessResult.textContent = '残念！正解は ' + answerNumber + ' でした。';
      guessSubmit.disabled = true; // 回答のボタンを無効化
      return; // 関数を終了
    }

    if (userGuess === answerNumber) { // ユーザの入力が正解
      guessResult.textContent = '正解です！';
    } else if (userGuess < answerNumber) { // ユーザの入力が正解より小さい
      guessResult.textContent = 'もっと大きいです';
    } else if (userGuess > answerNumber) { // ユーザの入力が正解より大きい
      guessResult.textContent = 'もっと小さいです';
    }
  }

  // submitがクリックされたときに、checkGuess関数を呼び出す
  guessSubmit.addEventListener('click', checkGuess);

  // resetがクリックされたときに、ゲームをリセットする
  guessReset.addEventListener('click', function() {
    window.prompt('ほ、本当に諦めるの？');

    zanki = 10; // 残り回数をリセット
    zankiField.textContent = '残り回数: ' + zanki; // 残り回数を更新
    guessField.value = ''; // 入力フィールドをクリア
    guessResult.textContent = ''; // 結果表示をクリア
    answerNumber = Math.floor(Math.random() * 100) + 1; // 新しい正解を生成
    audio.pause(); //audioを止める
    audio.currentTime = 0; //時間を０に
  });
</script>

</body>
</html>